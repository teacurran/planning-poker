# System Architecture Blueprint: Scrum Poker Platform

**Version:** 1.0
**Date:** 2025-10-17
**Generated By:** Claude Sonnet 4.5

---

<!-- anchor: introduction-and-goals -->
## 1. Introduction & Goals

<!-- anchor: project-vision -->
### 1.1. Project Vision

The Scrum Poker Platform is a lightweight, real-time collaborative estimation tool designed for Agile teams of 2-12 players. The system enables distributed teams to conduct efficient estimation sessions through anonymous play, persistent user preferences, and tiered subscription models. The platform combines real-time WebSocket-based gameplay with a robust monetization strategy spanning free ad-supported usage to enterprise SSO-enabled organizations.

<!-- anchor: key-objectives -->
### 1.2. Key Objectives

- **Real-time Collaboration:** Enable sub-second latency for card selection, reveal, and room state synchronization across all participants
- **Frictionless Onboarding:** Support instant anonymous play with zero registration barriers while offering enhanced features for authenticated users
- **Horizontal Scalability:** Support multiple concurrent sessions across distributed server nodes with seamless WebSocket failover
- **Multi-tier Monetization:** Implement flexible subscription tiers (Free, Pro, Pro+, Enterprise) with integrated Stripe payment flows
- **Enterprise Readiness:** Provide SSO integration (OIDC/SAML2), organization management, and compliance-grade audit logging
- **Comprehensive Analytics:** Deliver tier-appropriate reporting from basic session summaries to detailed organizational dashboards
- **Mobile-First UX:** Ensure responsive design with optimal touch interfaces for tablets and smartphones
- **Security & Privacy:** Implement JWT-based authentication, HTTPS-only communications, and anonymous session isolation

<!-- anchor: scope -->
### 1.3. Scope

**In Scope:**
- Real-time Scrum Poker gameplay engine with WebSocket communication
- User authentication via OAuth2 (Google, Microsoft) and SSO (Enterprise)
- Multi-tier subscription management with Stripe integration
- Room management (creation, joining, privacy controls, persistence)
- Customizable estimation decks and room configurations
- Reporting and analytics (tier-dependent feature sets)
- Organization management and admin controls (Enterprise)
- Responsive web application (mobile, tablet, desktop)
- Marketing website with pricing, demo, and content pages
- Payment processing and subscription lifecycle management

**Out of Scope:**
- Native mobile applications (iOS/Android) - web-first approach
- Video/audio conferencing integration
- Project management tool integrations (Jira, Azure DevOps) - future consideration
- AI-powered estimation suggestions
- Offline mode capabilities
- White-label/self-hosted deployment options in initial release

<!-- anchor: key-assumptions -->
### 1.4. Key Assumptions

1. **User Base:** Primary target is small to medium Agile teams (2-12 concurrent users per session), with peak concurrency of ~500 simultaneous sessions
2. **Geographic Distribution:** Initial deployment targets North America and Europe with <100ms latency requirements within regions
3. **Session Duration:** Average estimation session lasts 30-60 minutes with 10-20 estimation rounds
4. **Technology Maturity:** Development team has expertise in Quarkus reactive programming, WebSocket patterns, and cloud-native deployment
5. **OAuth Provider Availability:** Google and Microsoft OAuth2 endpoints maintain >99.9% uptime
6. **Payment Processing:** Stripe services are available and compliant in target markets
7. **Browser Support:** Modern evergreen browsers (Chrome, Firefox, Safari, Edge) with WebSocket and ES2020+ support
8. **Regulatory Compliance:** GDPR and basic data protection requirements apply; SOC2/HIPAA not required in initial release
9. **Infrastructure:** Kubernetes-based container orchestration is available for deployment with auto-scaling capabilities

---

<!-- anchor: architectural-drivers -->
## 2. Architectural Drivers

<!-- anchor: functional-requirements-summary -->
### 2.1. Functional Requirements Summary

<!-- anchor: core-gameplay-requirements -->
#### Core Gameplay Requirements
- **Real-time Estimation:** WebSocket-based blind card selection with configurable deck types (Fibonacci, T-shirt, custom)
- **Session Management:** Host controls for round lifecycle (start, lock, reveal, reset), participant management (kick, mute)
- **Calculation Engine:** Automatic computation of average, median, and consensus indicators upon reveal
- **Room Controls:** Unique room ID generation (6-character nanoid), shareable links, privacy modes

<!-- anchor: user-account-requirements -->
#### User Account Requirements
- **OAuth2 Authentication:** Google and Microsoft social login integration
- **Profile Management:** Display name, avatar, theme preferences, default room settings
- **Session History:** Persistent storage of past sessions with tier-based access controls
- **Preference Persistence:** User-specific defaults for deck type, room rules, reveal behavior

<!-- anchor: monetization-requirements -->
#### Monetization Requirements
- **Stripe Integration:** Subscription management, payment processing, webhook handling
- **Tier Enforcement:** Feature gating based on subscription level (ads, reports, room privacy, branding)
- **Upgrade Flows:** In-app prompts, modal CTAs, settings panel upsells
- **Billing Dashboard:** Subscription status, payment history, plan management

<!-- anchor: reporting-requirements -->
#### Reporting Requirements
- **Free Tier:** Basic session summaries (story count, consensus rate, average vote)
- **Pro Tier:** Round-level detail, user consistency metrics, CSV/JSON/PDF export
- **Enterprise Tier:** Organizational dashboards, team trends, SSO-filtered reports, audit logs

<!-- anchor: enterprise-requirements -->
#### Enterprise Requirements
- **SSO Integration:** OIDC and SAML2 protocol support for identity federation
- **Organization Management:** Workspace creation, custom branding, org-wide defaults
- **Role-Based Access:** Admin/member roles with configurable permissions
- **Audit Logging:** Comprehensive event tracking for compliance and security monitoring

<!-- anchor: collaboration-requirements -->
#### Collaboration Requirements
- **Presence Indicators:** Real-time display of participant ready states and connection status
- **Observer Mode:** Non-voting participants for managers and stakeholders
- **Chat & Reactions:** Text chat and emoji reactions during estimation rounds
- **Animated Reveals:** Configurable card flip animations and reveal patterns

<!-- anchor: non-functional-requirements -->
### 2.2. Non-Functional Requirements (NFRs)

<!-- anchor: performance-nfrs -->
#### Performance
- **Latency:** <200ms round-trip time for WebSocket messages within region
- **Throughput:** Support 500 concurrent sessions with 6,000 active WebSocket connections
- **Response Time:** REST API endpoints respond within <500ms for p95
- **Real-time Updates:** State synchronization across clients within 100ms

<!-- anchor: scalability-nfrs -->
#### Scalability
- **Horizontal Scaling:** Stateless application nodes behind load balancer with session affinity
- **Connection Distribution:** WebSocket connections distributed across multiple backend nodes using Redis Pub/Sub
- **Database Scaling:** Read replicas for reporting queries, connection pooling for transactional load
- **Auto-scaling:** Kubernetes HPA based on CPU/memory and custom WebSocket connection metrics

<!-- anchor: availability-nfrs -->
#### Availability
- **Target Uptime:** 99.5% monthly uptime (excluding planned maintenance)
- **Fault Tolerance:** Graceful degradation when non-critical services (analytics, reporting) are unavailable
- **WebSocket Reconnection:** Automatic client-side reconnection with exponential backoff
- **Health Monitoring:** Readiness and liveness probes for container orchestration

<!-- anchor: security-nfrs -->
#### Security
- **Transport Security:** HTTPS/TLS 1.3 for all communications, WSS for WebSocket connections
- **Authentication:** JWT tokens with 1-hour expiration, refresh token rotation
- **Authorization:** Role-based access control (RBAC) for organization features
- **Data Protection:** Encryption at rest for sensitive data (PII, payment info), GDPR compliance
- **Session Isolation:** Anonymous session data segregated by room ID, automatic cleanup after 24 hours

<!-- anchor: maintainability-nfrs -->
#### Maintainability
- **Code Organization:** Domain-driven design with clear bounded contexts
- **API Versioning:** Semantic versioning for REST APIs, backward-compatible WebSocket protocol
- **Logging:** Structured JSON logging with correlation IDs across distributed traces
- **Monitoring:** Prometheus metrics, Grafana dashboards, alerting for critical failures

<!-- anchor: usability-nfrs -->
#### Usability
- **Responsive Design:** Mobile-first Tailwind CSS with breakpoints for tablet/desktop
- **Accessibility:** WCAG 2.1 Level AA compliance for keyboard navigation and screen readers
- **Browser Support:** Last 2 versions of Chrome, Firefox, Safari, Edge
- **Internationalization:** English language in initial release, i18n framework for future localization

<!-- anchor: constraints-and-preferences -->
### 2.3. Constraints & Preferences

<!-- anchor: technology-constraints -->
#### Technology Constraints
- **Backend Framework:** Quarkus with Hibernate Reactive (specified requirement)
- **Database:** PostgreSQL for relational data integrity and JSONB support
- **Cache/Message Bus:** Redis for session state distribution and Pub/Sub messaging
- **Payment Provider:** Stripe for subscription billing and payment processing
- **Containerization:** Docker containers orchestrated via Kubernetes

<!-- anchor: architectural-constraints -->
#### Architectural Constraints
- **Stateless Services:** Application nodes must be stateless to enable horizontal scaling
- **Cloud-Native:** Design for containerized deployment with 12-factor app principles
- **WebSocket Affinity:** Load balancer must support sticky sessions or Redis-backed session sharing
- **Reactive Patterns:** Leverage Quarkus reactive capabilities for non-blocking I/O

<!-- anchor: organizational-constraints -->
#### Organizational Constraints
- **Team Expertise:** Development team skilled in Java, Quarkus, reactive programming, and cloud-native patterns
- **Timeline:** MVP delivery expected within 4-6 months with iterative feature releases
- **Budget:** Cloud infrastructure budget accommodates moderate auto-scaling with cost optimization
- **Compliance:** Must adhere to GDPR, CCPA, and standard data protection regulations

<!-- anchor: preferences -->
#### Preferences
- **Frontend Framework:** React or Vue preferred for SPA development with strong ecosystem
- **CSS Framework:** Tailwind CSS for rapid UI development and consistent design system
- **Observability:** Prometheus/Grafana stack for metrics, ELK or Loki for centralized logging
- **CI/CD:** GitLab CI or GitHub Actions for automated testing, building, and deployment
- **Deployment Target:** AWS or GCP with managed Kubernetes (EKS/GKE) for reduced operational overhead
